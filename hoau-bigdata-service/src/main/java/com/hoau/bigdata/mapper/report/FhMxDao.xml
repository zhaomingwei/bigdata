<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hoau.bigdata.mapper.report.FhMxDao">

    <!--长途发货：查询1分钟内（包括一分钟）准备装车、装车完成状态发货明细列表,BUSSESCODE-0长途发货-->
    <select id="queryInTimeLDFhMxList" parameterType="int" resultType="com.hoau.bigdata.entity.report.FhMxAndDhMx">
          SELECT FH.FCBH,
               TRIM(QK.CPH) CPH,
               FH.SCGSBH SHGS,
               FH.GSBH XHGS,
               TJGS.GSJC TJGS,
               QK.ZCDH ZXDH,
               FH.ZT,
               TO_CHAR(QK.FCSJ, 'yyyy-MM-dd hh24:mi:ss') FCSJ,
               TO_CHAR(QK.SCSJ, 'yyyy-MM-dd hh24:mi:ss') SCSJ,
               QK.ZCWCSJ,
               TO_CHAR(QK.SCSJ, 'yyyy-MM-dd') TJSJ,
               SUBSTR(QK.FCBH, 0, INSTR(QK.FCBH, '-', 1) - 1) NAMELINE,
               QK.GSBH FCGS,
               QK.MDDGS DCGS,
               MX.JHCKJS,
               MX.SJCKJS,
               MX.YDBH,
               YD.ZL,
               YD.JS,
               YD.TJ,
               '1' TAG,
               '0' BUSSESCODE
          FROM HYDATA.LD_FHD FH
          LEFT JOIN HYDATA.LD_FHCLQK QK
            ON QK.FCBH = FH.FCBH
          LEFT JOIN HYDATA.LD_FHDMX MX
            ON MX.FHDBH = FH.FHDBH
          LEFT JOIN HYDATA.LD_YD YD
            ON YD.YDBH = MX.YDBH
          LEFT JOIN HYDATA.LD_GS TJGS
            ON TJGS.GSBH = FH.SCGSBH
         WHERE QK.SCSJ >= SYSDATE - #{sec} / (1440 * 60)
           AND QK.GSBH = FH.SCGSBH
           AND QK.ZCLX NOT IN (1, 2, 6, 12, 14)
           AND FH.ZT IN (0, 1)
           AND QK.ZCDH IS NOT NULL
    </select>

    <!--长途发货：查询1分钟之前2天之内准备装车、装车完成状态发货明细列表-->
    <select id="queryOutTimeLDFhMxList" parameterType="int" resultType="com.hoau.bigdata.entity.report.FhMxAndDhMx">
          SELECT FH.FCBH,
               TRIM(QK.CPH) CPH,
               FH.SCGSBH SHGS,
               FH.GSBH XHGS,
               TJGS.GSJC TJGS,
               QK.ZCDH ZXDH,
               FH.ZT,
               TO_CHAR(QK.FCSJ, 'yyyy-MM-dd hh24:mi:ss') FCSJ,
               TO_CHAR(QK.SCSJ, 'yyyy-MM-dd hh24:mi:ss') SCSJ,
               QK.ZCWCSJ,
               TO_CHAR(QK.SCSJ, 'yyyy-MM-dd') TJSJ,
               SUBSTR(QK.FCBH, 0, INSTR(QK.FCBH, '-', 1) - 1) NAMELINE,
               QK.GSBH FCGS,
               QK.MDDGS DCGS,
               MX.JHCKJS,
               MX.SJCKJS,
               MX.YDBH,
               YD.ZL,
               YD.JS,
               YD.TJ,
               '2' TAG,
               '0' BUSSESCODE
          FROM HYDATA.LD_FHD FH
          LEFT JOIN HYDATA.LD_FHCLQK QK
            ON QK.FCBH = FH.FCBH
          LEFT JOIN HYDATA.LD_FHDMX MX
            ON MX.FHDBH = FH.FHDBH
          LEFT JOIN HYDATA.LD_YD YD
            ON YD.YDBH = MX.YDBH
          LEFT JOIN HYDATA.LD_GS TJGS
            ON TJGS.GSBH = FH.SCGSBH
         WHERE QK.SCSJ >= TRUNC(SYSDATE) - #{day}
           AND QK.SCSJ &lt; SYSDATE - #{sec} / (1440 * 60)
           AND QK.GSBH = FH.SCGSBH
           AND QK.ZCLX NOT IN (1, 2, 6, 12, 14)
           AND FH.ZT IN (0, 1)
           AND QK.ZCDH IS NOT NULL
    </select>

    <!--中转发货：查询1分钟内（包括一分钟）准备装车、装车完成状态发货明细列表,BUSSESCODE-1中转发货-->
    <select id="queryInTimeTSFhMxList" parameterType="int" resultType="com.hoau.bigdata.entity.report.FhMxAndDhMx">
        SELECT FH.FCBH,
               TRIM(QK.CPH) CPH,
               FH.SCGSBH SHGS,
               FH.GSBH XHGS,
               TJGS.GSJC TJGS,
               TJD.ZCDH ZXDH,
               FH.ZT,
               TO_CHAR(TJD.FCSJ, 'yyyy-MM-dd hh24:mi:ss') FCSJ,
               TO_CHAR(QK.SCSJ, 'yyyy-MM-dd hh24:mi:ss') SCSJ,
               QK.ZCWCSJ,
               TO_CHAR(TJD.DCSJ, 'yyyy-MM-dd') TJSJ,
               SUBSTR(QK.FCBH, 0, INSTR(QK.FCBH, '-', 1) - 1) NAMELINE,
               QK.GSBH FCGS,
               QK.MDDGS DCGS,
               MX.JHCKJS,
               MX.SJCKJS,
               MX.YDBH,
               YD.ZL,
               YD.JS,
               YD.TJ,
               '1' TAG,
               '1' BUSSESCODE
          FROM HYDATA.LD_FHD FH
          LEFT JOIN HYDATA.LD_FHCLQK QK
            ON QK.FCBH = FH.FCBH
          LEFT JOIN HYDATA.LD_CLTJD TJD
            ON FH.FCBH = TJD.FCBH
          LEFT JOIN HYDATA.LD_FHDMX MX
            ON MX.FHDBH = FH.FHDBH
          LEFT JOIN HYDATA.LD_YD YD
            ON YD.YDBH = MX.YDBH
          LEFT JOIN HYDATA.LD_GS TJGS
            ON TJGS.GSBH = FH.SCGSBH
         WHERE TJD.DCSJ >= SYSDATE - #{sec} / (1440 * 60)
           AND TJD.GSBH = FH.SCGSBH
           AND QK.ZCLX NOT IN (1, 2, 6, 12, 14)
           AND FH.ZT IN (0, 1)
           AND TJD.ZCDH IS NOT NULL
    </select>

    <!--中转发货：查询1分钟之前2天之内准备装车、装车完成状态发货明细列表-->
    <select id="queryOutTimeTSFhMxList" parameterType="int" resultType="com.hoau.bigdata.entity.report.FhMxAndDhMx">
           SELECT FH.FCBH,
               TRIM(QK.CPH) CPH,
               FH.SCGSBH SHGS,
               FH.GSBH XHGS,
               TJGS.GSJC TJGS,
               TJD.ZCDH ZXDH,
               FH.ZT,
               TO_CHAR(TJD.FCSJ, 'yyyy-MM-dd hh24:mi:ss') FCSJ,
               TO_CHAR(QK.SCSJ, 'yyyy-MM-dd hh24:mi:ss') SCSJ,
               QK.ZCWCSJ,
               TO_CHAR(TJD.DCSJ, 'yyyy-MM-dd') TJSJ,
               SUBSTR(QK.FCBH, 0, INSTR(QK.FCBH, '-', 1) - 1) NAMELINE,
               QK.GSBH FCGS,
               QK.MDDGS DCGS,
               MX.JHCKJS,
               MX.SJCKJS,
               MX.YDBH,
               YD.ZL,
               YD.JS,
               YD.TJ,
               '2' TAG,
               '1' BUSSESCODE
          FROM HYDATA.LD_FHD FH
          LEFT JOIN HYDATA.LD_FHCLQK QK
            ON QK.FCBH = FH.FCBH
          LEFT JOIN HYDATA.LD_CLTJD TJD
            ON FH.FCBH = TJD.FCBH
          LEFT JOIN HYDATA.LD_FHDMX MX
            ON MX.FHDBH = FH.FHDBH
          LEFT JOIN HYDATA.LD_YD YD
            ON YD.YDBH = MX.YDBH
          LEFT JOIN HYDATA.LD_GS TJGS
            ON TJGS.GSBH = FH.SCGSBH
         WHERE TJD.DCSJ >= TRUNC(SYSDATE) - #{day}
           AND TJD.DCSJ &lt; SYSDATE - #{sec} / (1440 * 60)
           AND TJD.GSBH = FH.SCGSBH
           AND QK.ZCLX NOT IN (1, 2, 6, 12, 14)
           AND FH.ZT IN (0, 1)
           AND TJD.ZCDH IS NOT NULL
    </select>

    <!--下转移发货：查询1分钟内（包括一分钟）准备装车、装车完成状态发货明细列表,BUSSESCODE-2下转移发货-->
    <select id="queryInTimeDTFhMxList" parameterType="int" resultType="com.hoau.bigdata.entity.report.FhMxAndDhMx">
        SELECT FH.FCBH,
               TRIM(FH.CPH) CPH,
               FH.GSBH SHGS,
               FH.MDDGS XHGS,
               TJGS.GSJC TJGS,
               FH.ZCDH ZXDH,
               FH.ZT,
               TO_CHAR(FH.FCSJ, 'yyyy-MM-dd hh24:mi:ss') FCSJ,
               TO_CHAR(FH.SCSJ, 'yyyy-MM-dd hh24:mi:ss') SCSJ,
               FH.ZCWCSJ,
               TO_CHAR(FH.SCSJ, 'yyyy-MM-dd') TJSJ,
               FH.GSBH || FH.MDDGS NAMELINE,
               FH.GSBH FCGS,
               FH.MDDGS DCGS,
               MX.JHCKJS,
               NVL(MX.SJCKJS, 0) SJCKJS,
               MX.YDBH,
               YD.ZL,
               YD.JS,
               YD.TJ,
               '1' TAG,
               '2' BUSSESCODE
          FROM HYDATA.LD_XZYFH FH
          LEFT JOIN HYDATA.LD_XZYMX MX
            ON FH.FCBH = MX.FCBH
          LEFT JOIN HYDATA.LD_YD YD
            ON YD.YDBH = MX.YDBH
          LEFT JOIN HYDATA.LD_GS TJGS
            ON TJGS.GSBH = FH.GSBH
         WHERE FH.SCSJ >= SYSDATE - #{sec} / (1440 * 60)
           AND FH.ZT IN (0, 1)
           AND FH.ZCDH IS NOT NULL
    </select>

    <!--下转移发货：查询1分钟之前2天之内准备装车、装车完成状态发货明细列表-->
    <select id="queryOutTimeDTFhMxList" parameterType="int" resultType="com.hoau.bigdata.entity.report.FhMxAndDhMx">
          SELECT FH.FCBH,
               TRIM(FH.CPH) CPH,
               FH.GSBH SHGS,
               FH.MDDGS XHGS,
               TJGS.GSJC TJGS,
               FH.ZCDH ZXDH,
               FH.ZT,
               TO_CHAR(FH.FCSJ, 'yyyy-MM-dd hh24:mi:ss') FCSJ,
               TO_CHAR(FH.SCSJ, 'yyyy-MM-dd hh24:mi:ss') SCSJ,
               FH.ZCWCSJ,
               TO_CHAR(FH.SCSJ, 'yyyy-MM-dd') TJSJ,
               FH.GSBH || FH.MDDGS NAMELINE,
               FH.GSBH FCGS,
               FH.MDDGS DCGS,
               MX.JHCKJS,
               NVL(MX.SJCKJS, 0) SJCKJS,
               MX.YDBH,
               YD.ZL,
               YD.JS,
               YD.TJ,
               '2' TAG,
               '2' BUSSESCODE
          FROM HYDATA.LD_XZYFH FH
          LEFT JOIN HYDATA.LD_XZYMX MX
            ON FH.FCBH = MX.FCBH
          LEFT JOIN HYDATA.LD_YD YD
            ON YD.YDBH = MX.YDBH
          LEFT JOIN HYDATA.LD_GS TJGS
            ON TJGS.GSBH = FH.GSBH
         WHERE FH.SCSJ >= TRUNC(SYSDATE) - #{day}
           AND FH.SCSJ &lt; SYSDATE - #{sec} / (1440 * 60)
           AND FH.ZT IN (0, 1)
           AND FH.ZCDH IS NOT NULL
    </select>

    <!--派送：查询1分钟内（包括一分钟）准备装车、装车完成状态发货明细列表,BUSSESCODE-3派送-->
    <select id="queryInTimeDLFhMxList" parameterType="int" resultType="com.hoau.bigdata.entity.report.FhMxAndDhMx">
        SELECT FH.SHDBH FCBH,
               TRIM(FH.CPH) CPH,
               FH.GSBH SHGS,
               FH.GSBH XHGS,
               TJGS.GSJC TJGS,
               FH.ZCDH ZXDH,
               FH.ZT,
               TO_CHAR(FH.FCSJ, 'yyyy-MM-dd hh24:mi:ss') FCSJ,
               TO_CHAR(FH.SCSJ, 'yyyy-MM-dd hh24:mi:ss') SCSJ,
               FH.ZCWCSJ,
               TO_CHAR(FH.SCSJ, 'yyyy-MM-dd') TJSJ,
               FH.GSBH FCGS,
               FH.GSBH DCGS,
               MX.JHCKJS,
               MX.SJCKJS,
               MX.YDBH,
               YD.ZL,
               YD.JS,
               YD.TJ,
               '1' TAG,
               '3' BUSSESCODE
          FROM HYDATA.LD_SHD FH
          LEFT JOIN HYDATA.LD_SHMX MX
            ON FH.SHDBH = MX.SHDBH
          LEFT JOIN HYDATA.LD_YD YD
            ON YD.YDBH = MX.YDBH
          LEFT JOIN HYDATA.LD_GS TJGS
            ON TJGS.GSBH = FH.GSBH
         WHERE FH.SCSJ >= SYSDATE - #{sec} / (1440 * 60)
           AND FH.ZT IN (0, 1)
           AND FH.ZCDH IS NOT NULL
    </select>

    <!--派送：查询1分钟之前2天之内准备装车、装车完成状态发货明细列表-->
    <select id="queryOutTimeDLFhMxList" parameterType="int" resultType="com.hoau.bigdata.entity.report.FhMxAndDhMx">
          SELECT FH.SHDBH FCBH,
               TRIM(FH.CPH) CPH,
               FH.GSBH SHGS,
               FH.GSBH XHGS,
               TJGS.GSJC TJGS,
               FH.ZCDH ZXDH,
               FH.ZT,
               TO_CHAR(FH.FCSJ, 'yyyy-MM-dd hh24:mi:ss') FCSJ,
               TO_CHAR(FH.SCSJ, 'yyyy-MM-dd hh24:mi:ss') SCSJ,
               FH.ZCWCSJ,
               TO_CHAR(FH.SCSJ, 'yyyy-MM-dd') TJSJ,
               FH.GSBH FCGS,
               FH.GSBH DCGS,
               MX.JHCKJS,
               MX.SJCKJS,
               MX.YDBH,
               YD.ZL,
               YD.JS,
               YD.TJ,
               '2' TAG,
               '3' BUSSESCODE
          FROM HYDATA.LD_SHD FH
          LEFT JOIN HYDATA.LD_SHMX MX
            ON FH.SHDBH = MX.SHDBH
          LEFT JOIN HYDATA.LD_YD YD
            ON YD.YDBH = MX.YDBH
          LEFT JOIN HYDATA.LD_GS TJGS
            ON TJGS.GSBH = FH.GSBH
         WHERE FH.SCSJ >= TRUNC(SYSDATE) - #{day}
           AND FH.SCSJ &lt; SYSDATE - #{sec} / (1440 * 60)
           AND FH.ZT IN (0, 1)
           AND FH.ZCDH IS NOT NULL
    </select>

    <!--长途发货：根据标签信息查询长途发货明细列表-->
    <select id="queryLxFhCtList" parameterType="java.util.List"
            resultType="com.hoau.bigdata.entity.report.FhMxAndDhMxOut">
            SELECT FH.FCBH,
                TRIM(QK.CPH) CPH,
                FH.SCGSBH SHGS,
                FH.SCGSBH TJGSCODE,
                FH.GSBH XHGS,
                TJGS.GSJC TJGS,
                QK.ZCDH ZXDH,
                FH.ZT,
                TO_CHAR(QK.FCSJ, 'yyyy-MM-dd hh24:mi:ss') FCSJ,
                TO_CHAR(QK.SCSJ, 'yyyy-MM-dd hh24:mi:ss') SCSJ,
                TO_CHAR(SYSDATE, 'yyyy-MM-dd hh24:mi:ss') CURRENTTIME,
                QK.ZCWCSJ,
                TO_CHAR(QK.SCSJ, 'yyyy-MM-dd') TJSJ,
                SUBSTR(QK.FCBH, 0, INSTR(QK.FCBH, '-', 1) - 1) NAMELINE,
                QK.GSBH FCGS,
                QK.MDDGS DCGS,
                MX.JHCKJS,
                NVL(MX.SJCKJS, 0) SJCKJS,
                MX.YDBH,
                YD.ZL,
                YD.JS,
                YD.TJ,
                '0' BUSSESCODE
            FROM HYDATA.LD_FHD FH
            LEFT JOIN HYDATA.LD_FHCLQK QK
              ON QK.FCBH = FH.FCBH
            LEFT JOIN HYDATA.LD_FHDMX MX
              ON MX.FHDBH = FH.FHDBH
            LEFT JOIN HYDATA.LD_YD YD
              ON YD.YDBH = MX.YDBH
            LEFT JOIN HYDATA.LD_GS TJGS
              ON TJGS.GSBH = FH.SCGSBH
            WHERE QK.GSBH = FH.SCGSBH
                AND QK.ZCLX NOT IN (1, 2, 6, 12, 14)
                AND FH.ZT IN (0, 1)
                AND QK.ZCDH IS NOT NULL
                AND <foreach collection="list" item="item" open="(" close=")" separator="or">
                    (QK.ZCDH = #{item.LOADPLANID}
                    AND MX.YDBH = #{item.CSGNID})
                </foreach>
    </select>

    <!--中转发货：根据标签信息查询中转发货明细列表-->
    <select id="queryLxFhZzList" parameterType="java.util.List"
            resultType="com.hoau.bigdata.entity.report.FhMxAndDhMxOut">
            SELECT FH.FCBH,
                TRIM(QK.CPH) CPH,
                FH.SCGSBH SHGS,
                FH.SCGSBH TJGSCODE,
                FH.GSBH XHGS,
                TJGS.GSJC TJGS,
                TJD.ZCDH ZXDH,
                FH.ZT,
                TO_CHAR(TJD.FCSJ, 'yyyy-MM-dd hh24:mi:ss') FCSJ,
                TO_CHAR(QK.SCSJ, 'yyyy-MM-dd hh24:mi:ss') SCSJ,
                TO_CHAR(SYSDATE, 'yyyy-MM-dd hh24:mi:ss') CURRENTTIME,
                QK.ZCWCSJ,
                TO_CHAR(TJD.DCSJ, 'yyyy-MM-dd') TJSJ,
                SUBSTR(QK.FCBH, 0, INSTR(QK.FCBH, '-', 1) - 1) NAMELINE,
                QK.GSBH FCGS,
                QK.MDDGS DCGS,
                MX.JHCKJS,
                NVL(MX.SJCKJS, 0) SJCKJS,
                MX.YDBH,
                YD.ZL,
                YD.JS,
                YD.TJ,
                '1' BUSSESCODE
            FROM HYDATA.LD_FHD FH
            LEFT JOIN HYDATA.LD_FHCLQK QK
              ON QK.FCBH = FH.FCBH
            LEFT JOIN HYDATA.LD_CLTJD TJD
              ON FH.FCBH = TJD.FCBH
            LEFT JOIN HYDATA.LD_FHDMX MX
              ON MX.FHDBH = FH.FHDBH
            LEFT JOIN HYDATA.LD_YD YD
              ON YD.YDBH = MX.YDBH
            LEFT JOIN HYDATA.LD_GS TJGS
              ON TJGS.GSBH = FH.SCGSBH
            WHERE TJD.GSBH = FH.SCGSBH
                AND QK.ZCLX NOT IN (1, 2, 6, 12, 14)
                AND FH.ZT IN (0, 1)
                AND TJD.ZCDH IS NOT NULL
                AND <foreach collection="list" item="item" open="(" close=")" separator="or">
                    (TJD.ZCDH = #{item.LOADPLANID}
                    AND MX.YDBH = #{item.CSGNID})
                </foreach>
    </select>

    <!--下转移发货：根据标签信息查询下转移明细列表-->
    <select id="queryLxFhXzyList" parameterType="java.util.List"
            resultType="com.hoau.bigdata.entity.report.FhMxAndDhMxOut">
            SELECT FH.FCBH,
                TRIM(FH.CPH) CPH,
                FH.GSBH SHGS,
                FH.GSBH TJGSCODE,
                FH.MDDGS XHGS,
                TJGS.GSJC TJGS,
                FH.ZCDH ZXDH,
                FH.ZT,
                TO_CHAR(FH.FCSJ, 'yyyy-MM-dd hh24:mi:ss') FCSJ,
                TO_CHAR(FH.SCSJ, 'yyyy-MM-dd hh24:mi:ss') SCSJ,
                TO_CHAR(SYSDATE, 'yyyy-MM-dd hh24:mi:ss') CURRENTTIME,
                FH.ZCWCSJ,
                TO_CHAR(FH.SCSJ, 'yyyy-MM-dd') TJSJ,
                FH.GSBH || FH.MDDGS NAMELINE,
                FH.GSBH FCGS,
                FH.MDDGS DCGS,
                MX.JHCKJS,
                NVL(MX.SJCKJS, 0) SJCKJS,
                MX.YDBH,
                YD.ZL,
                YD.JS,
                YD.TJ,
                '2' BUSSESCODE
            FROM HYDATA.LD_XZYFH FH
            LEFT JOIN HYDATA.LD_XZYMX MX
              ON FH.FCBH = MX.FCBH
            LEFT JOIN HYDATA.LD_YD YD
              ON YD.YDBH = MX.YDBH
            LEFT JOIN HYDATA.LD_GS TJGS
              ON TJGS.GSBH = FH.GSBH
            WHERE FH.ZT IN (0, 1)
                AND FH.ZCDH IS NOT NULL
                AND <foreach collection="list" item="item" open="(" close=")" separator="or">
                    (FH.ZCDH = #{item.LOADPLANID}
                    AND MX.YDBH = #{item.CSGNID})
                </foreach>
    </select>

    <!--派送发货：根据标签信息查询派送明细列表-->
    <select id="queryLxFhPsList" parameterType="java.util.List"
            resultType="com.hoau.bigdata.entity.report.FhMxAndDhMxOut">
            SELECT FH.SHDBH FCBH,
                TRIM(FH.CPH) CPH,
                FH.GSBH SHGS,
                FH.GSBH TJGSCODE,
                FH.GSBH XHGS,
                TJGS.GSJC TJGS,
                FH.ZCDH ZXDH,
                FH.ZT,
                TO_CHAR(FH.FCSJ, 'yyyy-MM-dd hh24:mi:ss') FCSJ,
                TO_CHAR(FH.SCSJ, 'yyyy-MM-dd hh24:mi:ss') SCSJ,
                TO_CHAR(SYSDATE, 'yyyy-MM-dd hh24:mi:ss') CURRENTTIME,
                FH.ZCWCSJ,
                TO_CHAR(FH.SCSJ, 'yyyy-MM-dd') TJSJ,
                FH.GSBH FCGS,
                FH.GSBH DCGS,
                MX.JHCKJS,
                NVL(MX.SJCKJS, 0) SJCKJS,
                MX.YDBH,
                YD.ZL,
                YD.JS,
                YD.TJ
            FROM HYDATA.LD_SHD FH
            LEFT JOIN HYDATA.LD_SHMX MX
              ON FH.SHDBH = MX.SHDBH
            LEFT JOIN HYDATA.LD_YD YD
              ON YD.YDBH = MX.YDBH
            LEFT JOIN HYDATA.LD_GS TJGS
              ON TJGS.GSBH = FH.GSBH
            WHERE FH.ZT IN (0, 1)
                AND FH.ZCDH IS NOT NULL
                AND <foreach collection="list" item="item" open="(" close=")" separator="or">
                    (FH.ZCDH = #{item.LOADPLANID}
                    AND MX.YDBH = #{item.CSGNID})
                </foreach>
    </select>

    <!--派送按发车编号分组统计该发车编号下所有运单的总重量、总体积、总件数-->
    <select id="queryPsFhTotalDataByFcbh" parameterType="java.util.List"
            resultType="com.hoau.bigdata.entity.report.FhMxAndDhMxOut">
        SELECT
            FH.SHDBH FCBH,
            FH.GSBH TJGSCODE,
            SUM(YD.ZL) TZL,
            SUM(YD.JS) TJS,
            SUM(YD.TJ) TTJ
        FROM HYDATA.LD_SHD FH
        LEFT JOIN HYDATA.LD_SHMX MX
          ON FH.SHDBH = MX.SHDBH
        LEFT JOIN HYDATA.LD_YD YD
          ON YD.YDBH = MX.YDBH
        WHERE FH.ZCDH IS NOT NULL
          AND
            <foreach collection="list" item="item" open="(" close=")" separator="or">
                FH.FCBH = #{item.FCBH} AND FH.GSBH = #{item.TJGSCODE}
            </foreach>
        GROUP BY FH.FCBH,FH.GSBH
    </select>

    <!--下转移发货按发车编号分组统计该发车编号下所有运单的总重量、总体积、总件数-->
    <select id="queryXzyFhTotalDataByFcbh" parameterType="java.util.List"
            resultType="com.hoau.bigdata.entity.report.FhMxAndDhMxOut">
        SELECT
            FH.FCBH,
            FH.GSBH TJGSCODE,
            SUM(YD.ZL) TZL,
            SUM(YD.JS) TJS,
            SUM(YD.TJ) TTJ
        FROM HYDATA.LD_XZYFH FH
        LEFT JOIN HYDATA.LD_XZYMX MX
          ON FH.FCBH = MX.FCBH
        LEFT JOIN HYDATA.LD_YD YD
          ON YD.YDBH = MX.YDBH
        WHERE FH.ZCDH IS NOT NULL
          AND
            <foreach collection="list" item="item" open="(" close=")" separator="or">
                FH.FCBH = #{item.FCBH} AND FH.GSBH = #{item.TJGSCODE}
            </foreach>
        GROUP BY FH.FCBH,FH.GSBH
    </select>

    <!--长途到货按发车编号分组统计该发车编号下所有运单的总重量、总体积、总件数-->
    <select id="queryCtFhTotalDataByFcbh" parameterType="java.util.List"
            resultType="com.hoau.bigdata.entity.report.FhMxAndDhMxOut">
        SELECT
            FH.FCBH,
            FH.SCGSBH TJGSCODE,
            SUM(YD.ZL) TZL,
            SUM(YD.JS) TJS,
            SUM(YD.TJ) TTJ
        FROM HYDATA.LD_FHD FH
        LEFT JOIN HYDATA.LD_FHCLQK QK
          ON QK.FCBH = FH.FCBH
        LEFT JOIN HYDATA.LD_FHDMX MX
          ON MX.FHDBH = FH.FHDBH
        LEFT JOIN HYDATA.LD_YD YD
          ON YD.YDBH = MX.YDBH
        LEFT JOIN HYDATA.LD_GS TJGS
          ON TJGS.GSBH = FH.SCGSBH
        WHERE QK.GSBH = FH.SCGSBH
          AND QK.ZCLX NOT IN (1, 2, 6, 12, 14)
          AND QK.ZCDH IS NOT NULL
          AND
              <foreach collection="list" item="item" open="(" close=")" separator="or">
                FH.FCBH = #{item.FCBH} AND FH.SCGSBH = #{item.TJGSCODE}
              </foreach>
        GROUP BY FH.FCBH,FH.SCGSBH
    </select>

    <!--中转发货按发车编号分组统计该发车编号下所有运单的总重量、总体积、总件数-->
    <select id="queryZzFhTotalDataByFcbh" parameterType="java.util.List"
            resultType="com.hoau.bigdata.entity.report.FhMxAndDhMxOut">
        SELECT
            FH.FCBH,
            SUM(YD.ZL) TZL,
            SUM(YD.JS) TJS,
            SUM(YD.TJ) TTJ
        FROM HYDATA.LD_FHD FH
        LEFT JOIN HYDATA.LD_FHCLQK QK
          ON QK.FCBH = FH.FCBH
        LEFT JOIN HYDATA.LD_CLTJD TJD
          ON FH.FCBH = TJD.FCBH
        LEFT JOIN HYDATA.LD_FHDMX MX
          ON MX.FHDBH = FH.FHDBH
        LEFT JOIN HYDATA.LD_YD YD
          ON YD.YDBH = MX.YDBH
        LEFT JOIN HYDATA.LD_GS TJGS
          ON TJGS.GSBH = FH.SCGSBH
        WHERE TJD.GSBH = FH.SCGSBH
          AND QK.ZCLX NOT IN (1, 2, 6, 12, 14)
          AND TJD.ZCDH IS NOT NULL
          AND
            <foreach collection="list" item="item" open="(" close=")" separator="or">
                FH.FCBH = #{item.FCBH} AND FH.SCGSBH = #{item.TJGSCODE}
            </foreach>
        GROUP BY FH.FCBH,FH.SCGSBH
    </select>

</mapper>